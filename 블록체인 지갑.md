## **블록체인 지갑과 회사 포인트 교체 개념 정리**
### 1. 블록체인 지갑은 공식 화폐(원화 등) 직접 사용 불가
- 블록체인 지갑은 디지털 자산(암호화폐, 토큰 등)만 저장 및 거래 가능.
- 즉, 카카오페이로 받은 원화 금액을 그대로 넣을 수 없음.

### 2. 암호화폐로 환전 후 지갑에 적립
- 카카오페이에서 결제된 금액을 회사 내부 환율(예: 1,000원 = 0.00001 ETH)로 암호화폐(예: 이더리움)로 변환하여 블록체인 지갑에 적립.
- 이때 블록체인에 +암호화폐 잔액 기록(블록 생성).

### 3. 암호화폐 가치 변동 문제
- 암호화폐 시세 변동성으로 인해 실제 환산 가치가 계속 달라짐.
- 예: 유저가 5,000원 결제했는데, 암호화폐 가격이 급락하면 유저가 가진 디지털 자산 가치가 급격히 하락하는 문제가 발생.

### 4. 회사 포인트로 재교환(전환)
- 유저가 암호화폐를 회사 내부에서 관리하는 포인트(고정 가치)를 선택해 전환.
- 전환 시, 블록체인에 -암호화폐 잔액 기록과 +포인트 잔액 기록을 동시에 남김.

### 5. 암호화폐 잔액은 ‘즉시 0’으로 마이너스 처리
- 포인트로 전환하는 순간, 유저 지갑 내 암호화폐 잔액은 0이 되어야 하므로
- 해당 암호화폐만큼 블록체인에 마이너스(출금) 기록 생성.

### 6. 회사 포인트는 별도 DB나 체인에 관리

- 회사 포인트는 실질적으로 유저가 쓰는 ‘화폐’ 역할을 하며, 가격 변동이 없음.
- 블록체인 상에 토큰 형식으로 관리하거나 별도 데이터베이스에 기록 가능. 내 생각에는 별도  db에 저장할꺼였으면 블록체인 지갑 할  이유가 없음 즉 블록체인 상 토큰형식  관리가 맞다고 봄

---

## 1. 지갑 생성 위치
- 유저 지갑 생성(4번)은 서비스 백엔드에서 관리하는 논리적 지갑 계정이며,
- 실제 블록체인 상 주소와 키 쌍도 여기서 관리 또는 연동

## 2. 고정 환율 적용 주의
- 고정 환율은 포토폴리오인 지금이나 이렇게
- 실무는 실시간 시세 반영, 혹은 회사 자체 보유 포인트와 환산 로직 필요

## 3. 포인트 관리
- 회사 포인트는 블록체인 지갑 내부에 토큰으로 관리 및 저장
- 회사가 직접 발행/관리 → 암호화폐와 독립성 유지 가능

## 블록체인 지갑 쓰는  이유
1. 거래기록, 자산 보유 내역 위변조 불가
2. 투명성 ( 누구나 거래 내역을 검증할 수 있음, 내부자 때매 문제 생길 시 증거 활용 가능)
3. 탈중앙화로 중앙서버 다운되도 자산은 안전

```
┌────────────────────────────────────────────────────────────┐
│ [1] 유저 결제 요청 (카카오페이)                              │
│     - 프론트에서 결제 버튼 클릭                              │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [2] 카카오페이 결제 승인 API 호출                            │
│     - 결제 금액 예시: 5,000원                               │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [3] 결제 승인 완료                                          │
│     - 결제 성공 응답 수신                                    │
│     - 유저 ID, 결제 금액, 결제 시간 등 정보 확보              │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [4] 블록체인 지갑 유무 확인                                  │ (유저 개인지갑이 아닌 이 서비스에서 지갑을 만들었는지, 개인지갑 잔액 0원 만들면 어색해지니)
│     - 유저 지갑 존재 여부 확인                               │
│     - 없으면 신규 지갑 생성                                  │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [5] 결제 로그 기록                                          │
│     - 로그 저장: 유저ID, 금액, 시간 등                       │
│     - 일반 로그 or 블록체인 로그로 저장                      │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [6] 암호화폐 환산 처리                                      │
│     - 고정환율 적용 예: 1,000원 = 0.00001 ETH               │
│     - 5,000원 × 0.00001 = 0.05 ETH                         │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [7] 블록체인 지갑에 ETH 적립 기록                           │
│     - Block #N: +0.05 ETH                                   │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [8] 포인트 전환 요청 처리                                   │
│     - 유저가 ETH → POINT 전환 선택                         │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [9] 블록체인 로그 처리 (전환 기록)                           │
│     - Block #N+1: -0.05 ETH                                │
│     - Block #N+2: +500 POINT (회사 포인트)                  │
└──────────────┬─────────────────────────────────────────────┘
               ↓
┌────────────────────────────────────────────────────────────┐
│ [10] 유저 지갑 포인트 출력                                  │
│      - 블록체인 체인에서 POINT 로그 합산                     │
│      - 최종: 500 POINT                                     │
└────────────────────────────────────────────────────────────┘

```
